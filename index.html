<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>音樂播放器justin</title>
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background: #0f172a;
    color: #e0e7ff;
    margin: 0;
    padding: 0;
  }
  #topLeftText {
    position: fixed;
    top: 10px;
    left: 10px;
    max-width: 300px;
    background: rgba(15, 23, 42, 0.6);
    padding: 12px;
    border-radius: 10px;
    font-size: 0.9rem;
    font-weight: 600;
    line-height: 1.4;
    user-select: none;
    z-index: 20;
  }
  #fileInput {
    margin: 20px;
  }
  #playlist {
    list-style: none;
    padding: 0;
    margin: 20px;
  }
  #playlist li {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 6px 10px;
    background: rgba(255,255,255,0.05);
    margin-bottom: 5px;
    border-radius: 6px;
  }
  #playlist li span {
    flex: 1;
    cursor: pointer;
  }
  .delete-btn {
    background: none;
    border: none;
    color: #f87171;
    font-size: 1.2rem;
    cursor: pointer;
  }
  audio {
    width: 90%;
    margin: 20px;
    display: block;
  }
</style>
</head>
<body>

<div id="topLeftText">
  用法介紹:<br />
  1. 你可以直接把檔案拖過來這裡。<br />
  2. 你可以點右上角的新增檔案來新增音樂。<br />
  3. 播放清單會自動播放，無須點擊檔案。<br />
  4. 點擊❌即可刪除檔案。
</div>

<input type="file" id="fileInput" accept="audio/*" multiple>
<audio id="audioPlayer" controls></audio>
<ul id="playlist"></ul>

<script>
  const fileInput = document.getElementById('fileInput');
  const audioPlayer = document.getElementById('audioPlayer');
  const playlist = document.getElementById('playlist');

  let songs = [];
  let currentIndex = 0;

  fileInput.addEventListener('change', (e) => {
    for (let file of e.target.files) {
      const url = URL.createObjectURL(file);
      songs.push({ name: file.name, url });
    }
    renderPlaylist();
    if (!audioPlayer.src && songs.length > 0) {
      playSong(0);
    }
  });

  function renderPlaylist() {
    playlist.innerHTML = '';
    songs.forEach((song, index) => {
      const li = document.createElement('li');
      const span = document.createElement('span');
      span.textContent = song.name;
      span.onclick = () => playSong(index);

      const delBtn = document.createElement('button');
      delBtn.textContent = '❌';
      delBtn.className = 'delete-btn';
      delBtn.onclick = () => deleteSong(index);

      li.appendChild(span);
      li.appendChild(delBtn);
      playlist.appendChild(li);
    });
  }

  function playSong(index) {
    currentIndex = index;
    audioPlayer.src = songs[index].url;
    audioPlayer.play();
  }

  function deleteSong(index) {
    songs.splice(index, 1);
    if (index === currentIndex) {
      if (songs.length > 0) {
        playSong(index % songs.length);
      } else {
        audioPlayer.src = '';
      }
    }
    renderPlaylist();
  }

  audioPlayer.addEventListener('ended', () => {
    if (songs.length > 0) {
      currentIndex = (currentIndex + 1) % songs.length;
      playSong(currentIndex);
    }
  });
</script>

</body>
</html>
