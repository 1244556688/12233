<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>音樂播放器justin</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f9fafb;
    margin: 0;
    padding: 20px;
  }
  h2 {
    margin-bottom: 10px;
  }
  #playlist {
    list-style: none;
    padding: 0;
  }
  #playlist li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 10px;
    margin-bottom: 4px;
    background: #fff;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s ease;
  }
  #playlist li:hover {
    background: #e5e7eb;
  }
  .delete-btn {
    background: transparent;
    border: none;
    color: #f87171;
    font-size: 1rem;
    cursor: pointer;
    transition: color 0.2s ease;
  }
  .delete-btn:hover {
    color: #dc2626;
  }
</style>
</head>
<body>

<h2>音樂播放器</h2>
<p>
1. 你可以直接把檔案拖過來這裡。<br>
2. 你可以點右上角的新增檔案來新增音樂。<br>
3. 播放清單會自動播放，無須點擊檔案。<br>
4. 如果要刪除檔案可點右邊垃圾桶按鈕刪除。
</p>

<input type="file" id="fileInput" accept="audio/*" multiple>
<ul id="playlist"></ul>
<audio id="audioPlayer" controls></audio>

<script>
  let playlist = [];
  let currentIndex = 0;
  const audioPlayer = document.getElementById('audioPlayer');
  const playlistEl = document.getElementById('playlist');
  const fileInput = document.getElementById('fileInput');

  fileInput.addEventListener('change', (event) => {
    handleFiles(event.target.files);
  });

  document.body.addEventListener('dragover', (event) => {
    event.preventDefault();
  });

  document.body.addEventListener('drop', (event) => {
    event.preventDefault();
    handleFiles(event.dataTransfer.files);
  });

  function handleFiles(files) {
    for (let file of files) {
      if (file.type.startsWith('audio/')) {
        playlist.push(file);
      }
    }
    renderPlaylist();
    if (playlist.length === 1) {
      playSong(0);
    }
  }

  function renderPlaylist() {
    playlistEl.innerHTML = '';
    playlist.forEach((file, index) => {
      const li = document.createElement('li');
      li.textContent = file.name;
      li.onclick = () => playSong(index);

      const deleteBtn = document.createElement('button');
      deleteBtn.className = 'delete-btn';
      deleteBtn.innerHTML = '🗑';
      deleteBtn.onclick = (e) => {
        e.stopPropagation();
        playlist.splice(index, 1);
        renderPlaylist();
        if (index === currentIndex) {
          audioPlayer.pause();
          if (playlist.length > 0) {
            currentIndex = index % playlist.length;
            playSong(currentIndex);
          }
        }
      };

      li.appendChild(deleteBtn);
      playlistEl.appendChild(li);
    });
  }

  function playSong(index) {
    currentIndex = index;
    const file = playlist[index];
    const url = URL.createObjectURL(file);
    audioPlayer.src = url;
    audioPlayer.play();
  }

  audioPlayer.addEventListener('ended', () => {
    if (playlist.length > 0) {
      currentIndex = (currentIndex + 1) % playlist.length;
      playSong(currentIndex);
    }
  });
</script>

</body>
</html>
